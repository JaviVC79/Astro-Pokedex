---
import GoBackButton from "../../../../components/GoBackButton.astro";
import {
    getPokemonTypes,
    getPokemonsByTypes,
    type PokemonResponse,
} from "../../../../lib/pokemon";

export async function getStaticPaths() {
    const data: PokemonResponse = await getPokemonTypes();
    const results = data.results;

    return results.map((pokemon) => ({
        params: { type: pokemon.name.toLowerCase() },
        props: { pokemon },
    }));
}

const { type } = Astro.params;
const { pokemon } = Astro.props;

const data: any = await getPokemonsByTypes(type);

const pokemonsByType = data!.map((item: any) => item.name);
---

<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Pokemons tipo: {type}</h1>
    <GoBackButton />
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {data.map((pokemon: any) => (
            pokemon.sprites.front_default !== null ? (
                <div class="bg-slate-200 hover:bg-slate-300 shadow-md rounded-lg p-4 flex flex-col items-center hover:scale-105 transition-transform">
                    <a href={`/pokemon/${pokemon.name}`} class="text-lg font-semibold mb-2">
                        {pokemon.name}
                    </a>
                    <img src={pokemon.sprites.front_default} alt={pokemon.name} class="w-24 h-24" />
                </div>
            ) : (
                <div class="bg-slate-200 hover:bg-slate-300 shadow-md rounded-lg p-4 flex flex-col items-center hover:scale-105 transition-transform">
                    <a href={`/pokemon/${pokemon.name}`} class="text-lg font-semibold mb-2">
                        {pokemon.name}
                    </a>
                    <img src={pokemon.sprites.other.showdown.front_default} alt={pokemon.name} class="w-24 h-24" />
                </div>
            )
        ))}
    </div>
</div>
